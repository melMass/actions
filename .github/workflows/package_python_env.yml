name: 👨🏻‍🔬 Test actions@package

on: [workflow_dispatch]
jobs:
  publish:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest]
    name: Package on ${{ matrix.os }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Install Environment
        id: py
        uses: melMass/actions@package-python
        with:
          python-version: 3.11
          dependencies: "numpy imageio"

      - name: Add Something
        shell: bash
        run: |
          source env/bin/activate
          pip install websockets

      - name: Pack Environment
        id: pack
        uses: melMass/actions@package-python
        with:
          mode: pack

      - name: Print Outputs
        shell: bash
        run: |
          echo "The full path of the zipped environment is: ${{ steps.pack.outputs.env-zip-path }}"
      - uses: actions/upload-artifact@v4
        with:
          name: ${{ matrix.os }}-env
          path: ${{ steps.pack.outputs.env-zip-path }}
