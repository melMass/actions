name: Test Free Space Action

on:
  push:
    branches:
      - free-space
    paths-ignore:
      - '**.md'
  pull_request:
    branches:
      - free-space
    paths-ignore:
      - '**.md'
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        
      - name: Show initial disk space
        run: df -h /
        
      - name: Test free space action
        id: free-space
        uses: ./
        
      - name: Verify disk space
        run: df -h /
        
      - name: Create workflow summary
        uses: melmass/actions@summary
        with:
          content: |
            # ðŸ§¹ Disk Space Cleanup Results
            
            ## ðŸ“Š Space Information
            
            | Metric | Value |
            | --- | --- |
            | ðŸ’¾ Initial Space | ${initial_space} |
            | ðŸ’¾ Final Space | ${final_space} |
            | âœ¨ Space Freed | **${space_freed_gb} GB** (${space_freed_mb} MB) |
            
          variables: |
            {
              "initial_space": "${{ steps.free-space.outputs.initial-space }}",
              "final_space": "${{ steps.free-space.outputs.final-space }}",
              "space_freed_gb": "${{ steps.free-space.outputs.space-freed-gb }}",
              "space_freed_mb": "${{ steps.free-space.outputs.space-freed-mb }}"
            }
